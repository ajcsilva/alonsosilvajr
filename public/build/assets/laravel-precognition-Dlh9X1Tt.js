import{a as k,i as M,b as z,m as ee}from"./axios-DZWJTO8Q.js";import{m as B,d as te,s as re,g as x,i as ne,o as H}from"./lodash-es-BeZXkzNc.js";let P=k.create(),G=(e,t)=>`${e.method}:${e.baseURL??t.defaults.baseURL??""}${e.url}`,_=e=>e.status===204&&e.headers["precognition-success"]==="true";const w={},h={get:(e,t={},s={})=>S(m("get",e,t,s)),post:(e,t={},s={})=>S(m("post",e,t,s)),patch:(e,t={},s={})=>S(m("patch",e,t,s)),put:(e,t={},s={})=>S(m("put",e,t,s)),delete:(e,t={},s={})=>S(m("delete",e,t,s)),use(e){return P=e,h},axios(){return P},fingerprintRequestsUsing(e){return G=e===null?()=>null:e,h},determineSuccessUsing(e){return _=e,h}},m=(e,t,s,i)=>({url:t,method:e,...i,...["get","delete"].includes(e)?{params:B({},s,i==null?void 0:i.params)}:{data:B({},s,i==null?void 0:i.data)}}),S=(e={})=>{const t=[se,ie,ae].reduce((s,i)=>i(s),e);return(t.onBefore??(()=>!0))()===!1?Promise.resolve(null):((t.onStart??(()=>null))(),P.request(t).then(async s=>{t.precognitive&&N(s);const i=s.status;let l=s;return t.precognitive&&t.onPrecognitionSuccess&&_(l)&&(l=await Promise.resolve(t.onPrecognitionSuccess(l)??l)),t.onSuccess&&oe(i)&&(l=await Promise.resolve(t.onSuccess(l)??l)),($(t,i)??(d=>d))(l)??l},s=>le(s)?Promise.reject(s):(t.precognitive&&N(s.response),($(t,s.response.status)??((l,y)=>Promise.reject(y)))(s.response,s))).finally(t.onFinish??(()=>null)))},se=e=>({...e,timeout:e.timeout??P.defaults.timeout??3e4,precognitive:e.precognitive!==!1,fingerprint:typeof e.fingerprint>"u"?G(e,P):e.fingerprint,headers:{...e.headers,"Content-Type":ue(e),...e.precognitive!==!1?{Precognition:!0}:{},...e.validate?{"Precognition-Validate-Only":Array.from(e.validate).join()}:{}}}),oe=e=>e>=200&&e<300,ie=e=>{var t;return typeof e.fingerprint!="string"||((t=w[e.fingerprint])==null||t.abort(),delete w[e.fingerprint]),e},ae=e=>typeof e.fingerprint!="string"||e.signal||e.cancelToken||!e.precognitive?e:(w[e.fingerprint]=new AbortController,{...e,signal:w[e.fingerprint].signal}),N=e=>{var t;if(((t=e.headers)==null?void 0:t.precognition)!=="true")throw Error("Did not receive a Precognition response. Ensure you have the Precognition middleware in place for the route.")},le=e=>{var t;return!M(e)||typeof((t=e.response)==null?void 0:t.status)!="number"||z(e)},$=(e,t)=>({401:e.onUnauthorized,403:e.onForbidden,404:e.onNotFound,409:e.onConflict,422:e.onValidationError,423:e.onLocked})[t],ue=e=>{var t,s,i;return((t=e.headers)==null?void 0:t["Content-Type"])??((s=e.headers)==null?void 0:s["Content-type"])??((i=e.headers)==null?void 0:i["content-type"])??(I(e.data)?"multipart/form-data":"application/json")},I=e=>A(e)||typeof e=="object"&&e!==null&&Object.values(e).some(t=>I(t)),A=e=>typeof File<"u"&&e instanceof File||e instanceof Blob||typeof FileList<"u"&&e instanceof FileList&&e.length>0,pe=e=>typeof e=="string"?e:e(),he=e=>typeof e=="string"?e.toLowerCase():e(),ve=(e,t={})=>{const s={errorsChanged:[],touchedChanged:[],validatingChanged:[],validatedChanged:[]};let i=!1,l=!1;const y=r=>r!==l?(l=r,s.validatingChanged):[];let d=[];const T=r=>{const n=[...new Set(r)];return d.length!==n.length||!n.every(o=>d.includes(o))?(d=n,s.validatedChanged):[]},K=()=>d.filter(r=>typeof p[r]>"u");let c=[];const C=r=>{const n=[...new Set(r)];return c.length!==n.length||!n.every(o=>c.includes(o))?(c=n,s.touchedChanged):[]};let p={};const F=r=>{const n=ce(r);return ne(p,n)?[]:(p=n,s.errorsChanged)},Q=r=>{const n={...p};return delete n[O(r)],F(n)},W=()=>Object.keys(p).length>0;let D=1500;const X=r=>{D=r,V.cancel(),V=U()};let j=t,R=null,L=[],q=null;const U=()=>te(r=>{e({get:(n,o={},a={})=>h.get(n,b(o),E(a,r,o)),post:(n,o={},a={})=>h.post(n,b(o),E(a,r,o)),patch:(n,o={},a={})=>h.patch(n,b(o),E(a,r,o)),put:(n,o={},a={})=>h.put(n,b(o),E(a,r,o)),delete:(n,o={},a={})=>h.delete(n,b(o),E(a,r,o))}).catch(n=>{var o;return z(n)||M(n)&&((o=n.response)==null?void 0:o.status)===422?null:Promise.reject(n)})},D,{leading:!0,trailing:!0});let V=U();const E=(r,n,o={})=>{const a={...r,...n},v=Array.from(a.validate??c);return{...n,...ee(r,n),validate:v,timeout:a.timeout??5e3,onValidationError:(u,g)=>([...T([...d,...v]),...F(B(H({...p},v),u.data.errors))].forEach(Z=>Z()),a.onValidationError?a.onValidationError(u,g):Promise.reject(g)),onSuccess:u=>(T([...d,...v]).forEach(g=>g()),a.onSuccess?a.onSuccess(u):u),onPrecognitionSuccess:u=>([...T([...d,...v]),...F(H({...p},v))].forEach(g=>g()),a.onPrecognitionSuccess?a.onPrecognitionSuccess(u):u),onBefore:()=>a.onBeforeValidation&&a.onBeforeValidation({data:o,touched:c},{data:j,touched:L})===!1||(a.onBefore||(()=>!0))()===!1?!1:(q=c,R=o,!0),onStart:()=>{y(!0).forEach(u=>u()),(a.onStart??(()=>null))()},onFinish:()=>{y(!1).forEach(u=>u()),L=q,j=R,q=R=null,(a.onFinish??(()=>null))()}}},Y=(r,n,o)=>{if(typeof r>"u"){V(o??{});return}if(A(n)&&!i){console.warn('Precognition file validation is not active. Call the "validateFiles" function on your form to enable it.');return}r=O(r),x(j,r)!==n&&(C([r,...c]).forEach(a=>a()),V(o??{}))},b=r=>i===!1?J(r):r,f={touched:()=>c,validate(r,n,o){return typeof r=="object"&&!("target"in r)&&(o=r,r=n=void 0),Y(r,n,o),f},touch(r){const n=Array.isArray(r)?r:[O(r)];return C([...c,...n]).forEach(o=>o()),f},validating:()=>l,valid:K,errors:()=>p,hasErrors:W,setErrors(r){return F(r).forEach(n=>n()),f},forgetError(r){return Q(r).forEach(n=>n()),f},reset(...r){if(r.length===0)C([]).forEach(n=>n());else{const n=[...c];r.forEach(o=>{n.includes(o)&&n.splice(n.indexOf(o),1),re(j,o,x(t,o))}),C(n).forEach(o=>o())}return f},setTimeout(r){return X(r),f},on(r,n){return s[r].push(n),f},validateFiles(){return i=!0,f}};return f},ge=e=>Object.keys(e).reduce((t,s)=>({...t,[s]:Array.isArray(e[s])?e[s][0]:e[s]}),{}),ce=e=>Object.keys(e).reduce((t,s)=>({...t,[s]:typeof e[s]=="string"?[e[s]]:e[s]}),{}),O=e=>typeof e!="string"?e.target.name:e,J=e=>{const t={...e};return Object.keys(t).forEach(s=>{const i=t[s];if(i!==null){if(A(i)){delete t[s];return}if(Array.isArray(i)){t[s]=i.filter(l=>!A(l));return}if(typeof i=="object"){t[s]=J(t[s]);return}}}),t};export{he as a,O as b,ve as c,h as d,pe as r,ge as t};
